<h1>List of photos</h1>

<form action="/create_photo">
  <label for="image_box">Image</label>
  <input id="image_box" type="file" name="query_image">

  <label for="caption_box">Caption</label>
  <textarea id="caption_box" type="text" name="query_caption" placeholder="Enter a caption for the photo..."></textarea>

  <input type="hidden" name="query_owner_id" value="<%= @current_user.id %>">

  <button>Add photo</button>
</form>

<hr>

<table border="1">
  <tr>
    <th>Image</th>
    <th>Caption</th>
    <th>Owner</th>
    <th>Posted</th>
    <th>Likes</th>
    <th></th>
  </tr>

  <% @list_of_photos.each do |a_photo| %>
    <tr>
      <td>
        <img src="<%= a_photo.image %>">
      </td>

      <td>
        <%= a_photo.caption %>
      </td>

      <td>
        <% x = User.where({ :id => a_photo.owner_id }) %>
        <%= x.at(0).username %>
      </td>

      <td>
        <%= time_ago_in_words(a_photo.created_at) %> ago
      </td>

      <td>
        <% y = Like.where({ :photo_id => a_photo.id }) %>
        <%= y.count %>
      </td>

      <td>
        <a href="/photos/<%= a_photo.id %>">Show details</a>
      </td>

    </tr>
  <% end %>

</table>
